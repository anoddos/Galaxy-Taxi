@page "/auction/AuctionsList"
@using GalaxyTaxi.Shared.Api.Interfaces
@using GalaxyTaxi.Shared.Api.Models.Auction
@using GalaxyTaxi.Shared.Api.Models.Filters
@using GoogleMapsComponents
@using GoogleMapsComponents.Maps
@inject IAuctionService AuctionService
@inject NavigationManager NavigationManager


<MudGrid>
    @foreach (var item in _auctionItems)
    {
        <MudItem xs="12">
            <MudPaper Elevation="3" Padding="16px" Class="auction-item">
                <div class="auction-item-map">
                    <GoogleMap @ref="@_map1" Options="@_mapOptions" Class="auction-item"></GoogleMap>
                </div>
                <div class="auction-item-details">
                    <h3>@item.Title</h3>
                    <ul>
                        @foreach (var location in item.Locations)
                        {
                            <li>@location</li>
                        }
                    </ul>
                    <p class="destination-location">@item.FinalLocation</p>
                </div>
                <div class="auction-item-price">
                    <p class="price">@item.Price</p>
                    <p class="bid-count">Bids: @item.BidCount</p>
                </div>
            </MudPaper>
        </MudItem>
    }
</MudGrid>

<style>


.auction-item {
    display: flex;
    flex-direction: column;
    margin: 20px 100px 20px;
}

.auction-item-map {
    height: 200px;
    width: 200px;
}

.auction-item-details {
    flex-grow: 1;
}

.destination-location {
    font-weight: bold;
}

.auction-item-price {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
}

.price {
    font-size: 18px;
    font-weight: bold;
}

.bid-count {
    font-size: 14px;
}

</style>


@code {
    
    private AuctionsFilter _model = new AuctionsFilter();
    private readonly List<AuctionItem> _auctionItems;
    private GoogleMap _map1;
    private MapOptions _mapOptions;
    
    public AuctionsList()
    {
        _auctionItems = GetAuctionItems();
    }

    protected override async void OnInitialized()
    {
        _mapOptions = new MapOptions()
        {
            Zoom = 13,
            Center = new LatLngLiteral()
            {
                Lat = 40.333,
                Lng = 41.33
            },
            MapTypeId = MapTypeId.Roadmap
        };
    }
    
    protected override async Task OnInitializedAsync()
    {
        //_auctionItems = (await AuctionService.GetAuction(new AuctionsFilter())).Auctions;
    }

    // Sample data for demonstration purposes
    List<AuctionItem> GetAuctionItems()
    {
        return new List<AuctionItem>
        {
            new AuctionItem
            {
                Title = "Item 1",
                Locations = new List<string> { "Location A", "Location B", "Location C" },
                FinalLocation = "Final Location X",
                Price = "$100",
                BidCount = 5
            },
            new AuctionItem
            {
                Title = "Item 2",
                Locations = new List<string> { "Location A", "Location B", "Location C" },
                FinalLocation = "Final Location X",
                Price = "$100",
                BidCount = 5
            },
            new AuctionItem
            {
                Title = "Item 3",
                Locations = new List<string> { "Location A", "Location B", "Location C" },
                FinalLocation = "Final Location X",
                Price = "$100",
                BidCount = 5
            }
            // Add more items...
        };
    }

    private class AuctionItem : AuctionInfo
    {
        public string Title { get; set; }
        public List<string> Locations { get; set; }
        public string FinalLocation { get; set; }
        public string Price { get; set; }
        public int BidCount { get; set; }
    }
}
